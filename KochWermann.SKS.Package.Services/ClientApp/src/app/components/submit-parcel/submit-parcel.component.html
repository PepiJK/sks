<h2>Submit Parcel</h2>

<form #parcelFrom="ngForm" (ngSubmit)="onSubmit()">
  <div class="kw-sender-wrapper">
    <h3>Sender</h3>
    <div>
      <mat-form-field hideRequiredMarker>
        <mat-label>Name</mat-label>
        <input matInput required [(ngModel)]="newParcel.sender.name" name="senderName">
        <mat-error *ngIf="parcelFrom.controls['senderName']?.hasError('required')">
          Name is <strong>required</strong>
        </mat-error>
      </mat-form-field>
      <mat-form-field hideRequiredMarker>
        <mat-label>Country</mat-label>
        <input matInput required [(ngModel)]="newParcel.sender.country" name="senderCountry">
        <mat-error *ngIf="parcelFrom.controls['senderCountry']?.hasError('required')">
          Country is <strong>required</strong>
        </mat-error>
      </mat-form-field>
    </div>
    <div>
      <mat-form-field hideRequiredMarker>
        <mat-label>Street</mat-label>
        <input matInput required [(ngModel)]="newParcel.sender.street" name="senderStreet">
        <mat-error *ngIf="parcelFrom.controls['senderStreet']?.hasError('required')">
          Street is <strong>required</strong>
        </mat-error>
      </mat-form-field>
      <mat-form-field hideRequiredMarker>
        <mat-label>Postal Code</mat-label>
        <input matInput required [(ngModel)]="newParcel.sender.postalCode" name="senderPostalCode">
        <mat-error *ngIf="parcelFrom.controls['senderPostalCode']?.hasError('required')">
          Postal Code is <strong>required</strong>
        </mat-error>
      </mat-form-field>
      <mat-form-field hideRequiredMarker>
        <mat-label>City</mat-label>
        <input matInput required [(ngModel)]="newParcel.sender.city" name="senderCity">
        <mat-error *ngIf="parcelFrom.controls['senderCity']?.hasError('required')">
          City is <strong>required</strong>
        </mat-error>
      </mat-form-field>
    </div>
  </div>

  <div class="kw-recipient-wrapper">
    <h3>Recipient</h3>
    <div>
      <mat-form-field hideRequiredMarker>
        <mat-label>Name</mat-label>
        <input matInput required [(ngModel)]="newParcel.recipient.name" name="recipientName">
        <mat-error *ngIf="parcelFrom.controls['recipientName']?.hasError('required')">
          Name is <strong>required</strong>
        </mat-error>
      </mat-form-field>
      <mat-form-field hideRequiredMarker>
        <mat-label>Country</mat-label>
        <input matInput required [(ngModel)]="newParcel.recipient.country" name="recipientCountry">
        <mat-error *ngIf="parcelFrom.controls['recipientCountry']?.hasError('required')">
          Country is <strong>required</strong>
        </mat-error>
      </mat-form-field>
    </div>
    <div>
      <mat-form-field hideRequiredMarker>
        <mat-label>Street</mat-label>
        <input matInput required [(ngModel)]="newParcel.recipient.street" name="recipientStreet">
        <mat-error *ngIf="parcelFrom.controls['recipientStreet']?.hasError('required')">
          Street is <strong>required</strong>
        </mat-error>
      </mat-form-field>
      <mat-form-field hideRequiredMarker>
        <mat-label>Postal Code</mat-label>
        <input matInput required [(ngModel)]="newParcel.recipient.postalCode" name="recipientPostalCode">
        <mat-error *ngIf="parcelFrom.controls['recipientPostalCode']?.hasError('required')">
          Postal Code is <strong>required</strong>
        </mat-error>
      </mat-form-field>
      <mat-form-field hideRequiredMarker>
        <mat-label>City</mat-label>
        <input matInput required [(ngModel)]="newParcel.recipient.city" name="recipientCity">
        <mat-error *ngIf="parcelFrom.controls['recipientCity']?.hasError('required')">
          City is <strong>required</strong>
        </mat-error>
      </mat-form-field>
    </div>
  </div>

  <div class="kw-weight-wrapper">
    <mat-form-field hideRequiredMarker>
      <mat-label>Weight</mat-label>
      <input type="number" min="0.1" step="0.1" matInput required [(ngModel)]="newParcel.weight" name="weight">
      <mat-error *ngIf="parcelFrom.controls['weight']?.hasError('required')">
        Weight is <strong>required</strong>
      </mat-error>
    </mat-form-field>
  </div>

  <button type="submit" mat-flat-button color="primary" [disabled]="!parcelFrom.form.valid || isLoading">Submit</button>

</form>

<div *ngIf="isLoading" class="kw-new-id-wrapper">
  <mat-spinner></mat-spinner>
</div>

<div *ngIf="!isLoading && newTrackingId" class="kw-new-id-wrapper">
  <i class="material-icons kw-submit-icon kw-color-primary">check</i>
  <div>
    <span class="kw-color-primary">Tracking Id</span>
    <h1>{{newTrackingId}}</h1>
  </div>
</div>

<div *ngIf="!isLoading && errorMessage" class="kw-new-id-wrapper">
  <i class="material-icons kw-submit-icon kw-color-warn">error</i>
  <div>
    <span class="kw-color-warn">Error</span>
    <h1>{{errorMessage}}</h1>
  </div>
</div>
